# THIS FILE IS AUTOGENERATED BY gen-dockerfiles.sh.
# SEE zeronet-Dockerfile FOR THE SOURCE FILE.

FROM alpine:3.13

# Base settings
ENV HOME /root

# Install packages

# Install packages

COPY install-dep-packages.sh /root/install-dep-packages.sh

RUN /root/install-dep-packages.sh install

COPY requirements.txt /root/requirements.txt

RUN pip3 install -r /root/requirements.txt \
 && /root/install-dep-packages.sh remove-makedeps \
 && echo "ControlPort 9051" >> /etc/tor/torrc \
 && echo "CookieAuthentication 1" >> /etc/tor/torrc

RUN python3 -V \
 && python3 -m pip list \
 && tor --version \
 && openssl version

# Add Zeronet source

COPY . /root
VOLUME /root/data

# Control if Tor proxy is started
ENV ENABLE_TOR false

WORKDIR /root

# Set upstart command
CMD (! ${ENABLE_TOR} || tor&) && python3 zeronet.py --ui_ip 0.0.0.0 --fileserver_port 26552

# Expose ports
EXPOSE 43110 26552

